{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\joiner\\\\Desktop\\\\suis-movil\\\\app\\\\pages\\\\LoginSceen.js\";\nimport React, { useContext, useState } from \"react\";\nimport axios from 'axios';\nimport qs from 'qs';\nimport Image from \"react-native-web/dist/exports/Image\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableHighlight from \"react-native-web/dist/exports/TouchableHighlight\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport login from \"../assets/styles/loginStyles\";\nimport { database } from \"../db/database\";\nimport { GlobalContext } from \"../context/MyContext\";\nexport default function LoginSceen(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      dataUser = _useState2[0],\n      setDataUser = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isRegisterLocal = _useState4[0],\n      setregisterLocal = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      username = _useState6[0],\n      setUsername = _useState6[1];\n\n  var _useState7 = useState(),\n      _useState8 = _slicedToArray(_useState7, 2),\n      passsword = _useState8[0],\n      setPassword = _useState8[1];\n\n  var gC = useContext(GlobalContext);\n\n  var funcSetregisterLocal = function funcSetregisterLocal() {\n    setregisterLocal();\n  };\n\n  var funcSetDataUser = function funcSetDataUser(val) {\n    setDataUser(val);\n  };\n\n  var formData = new FormData();\n\n  var goToHome = function goToHome() {\n    return _regeneratorRuntime.async(function goToHome$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            database.setupDatabaseUserAsync();\n            database.getUSer(username, passsword, funcSetDataUser);\n\n            if (!(dataUser === null || dataUser.length === 0)) {\n              _context.next = 9;\n              break;\n            }\n\n            formData.append(\"user\", username);\n            formData.append(\"password\", passsword);\n            _context.next = 7;\n            return _regeneratorRuntime.awrap(axios.post(\"http://sistemas.mpps.gob.ve/index.php/api/login\", formData, {\n              header: {\n                'Content-Type': 'application/x-www-form-urlencoded'\n              }\n            }).then(function (r) {\n              if (r.data !== null) {\n                database.insertUser(r.data, username, passsword, funcSetregisterLocal);\n\n                if (isRegisterLocal) {\n                  gC.setIdUser(r.data);\n                  database.setupDatabaseAsync();\n                  database.getFicha(gC.setDataGlobal);\n                  navigation.navigate('PrincipalPages');\n                } else {\n                  alert('no se pudieron guardar los datos del usuario localmente');\n                  gC.setIdUser(r.data);\n                  database.setupDatabaseAsync();\n                  database.getFicha(gC.setDataGlobal);\n                  navigation.navigate('PrincipalPages');\n                }\n              }\n            }).catch(function (e) {\n              alert('Sus datos son incorrecto');\n            }));\n\n          case 7:\n            _context.next = 10;\n            break;\n\n          case 9:\n            console.log(dataUser);\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(KeyboardAvoidingView, {\n    behavior: Platform.OS == \"ios\" ? \"padding\" : \"height\",\n    style: login.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: login.bgGroundDark,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: login.logoLogin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }\n  }, React.createElement(Image, {\n    source: require(\"../assets/images/mpps-logo.png\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 11\n    }\n  })), React.createElement(View, {\n    style: login.inputContainerDark,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }\n  }, React.createElement(TextInput, {\n    style: login.inputDark,\n    autoCompleteType: \"username\",\n    autoFocus: true,\n    placeholder: \"Usuario\",\n    placeholderTextColor: \"white\",\n    onChangeText: function onChangeText(text) {\n      return setUsername(text);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 11\n    }\n  }), React.createElement(TextInput, {\n    style: login.inputDark,\n    autoCompleteType: \"password\",\n    placeholder: \"Contrase\\xF1a\",\n    placeholderTextColor: \"white\",\n    textContentType: \"password\",\n    secureTextEntry: true,\n    onChangeText: function onChangeText(text) {\n      return setPassword(text);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 11\n    }\n  })), React.createElement(View, {\n    style: login.contentButonLogin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 9\n    }\n  }, React.createElement(TouchableHighlight, {\n    onPress: function onPress() {\n      return goToHome();\n    },\n    underlayColor: \"transparent\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 11\n    }\n  }, React.createElement(View, {\n    style: login.buttLogin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: login.textButoon,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 15\n    }\n  }, \"Iniciar\")))), React.createElement(View, {\n    style: login.suisContText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: login.suisText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 11\n    }\n  }, \"SUIS\"))));\n}","map":{"version":3,"sources":["C:/Users/joiner/Desktop/suis-movil/app/pages/LoginSceen.js"],"names":["React","useContext","useState","axios","qs","login","database","GlobalContext","LoginSceen","navigation","dataUser","setDataUser","isRegisterLocal","setregisterLocal","username","setUsername","passsword","setPassword","gC","funcSetregisterLocal","funcSetDataUser","val","formData","FormData","goToHome","setupDatabaseUserAsync","getUSer","length","append","post","header","then","r","data","insertUser","setIdUser","setupDatabaseAsync","getFicha","setDataGlobal","navigate","alert","catch","e","console","log","Platform","OS","container","bgGroundDark","logoLogin","require","inputContainerDark","inputDark","text","contentButonLogin","buttLogin","textButoon","suisContText","suisText"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from \"react\";\r\nimport axios from 'axios';\r\nimport qs from 'qs';\r\nimport { Image, View, TextInput, Text, TouchableHighlight, KeyboardAvoidingView, Platform, Alert } from \"react-native\";\r\nimport login from \"../assets/styles/loginStyles\";\r\nimport { database } from \"../db/database\";\r\nimport { GlobalContext } from '../context/MyContext'\r\nexport default function LoginSceen({ navigation }) {\r\n  const [dataUser, setDataUser] = useState([]);\r\n  const [isRegisterLocal, setregisterLocal] = useState(false)\r\n  const [username, setUsername] = useState('');\r\n  const [passsword, setPassword] = useState();\r\n  const gC = useContext(GlobalContext);\r\n  const funcSetregisterLocal = () => {\r\n    setregisterLocal();\r\n  }\r\n  const funcSetDataUser = (val) => {\r\n    setDataUser(val)\r\n  }\r\n  const formData = new FormData();\r\n  // TODO AGG PANTALLA DE CARGA\r\n  const goToHome = async () => {\r\n    /**\r\n     * ? consultamos si existe la table de usuarios si es asi consultamos alli primero\r\n     */\r\n    database.setupDatabaseUserAsync()\r\n    database.getUSer(username, passsword, funcSetDataUser);\r\n    //console.log(dataUser)\r\n     if (dataUser === null || dataUser.length === 0) {\r\n      formData.append(\"user\", username);\r\n      formData.append(\"password\", passsword);\r\n      await axios.post(`http://sistemas.mpps.gob.ve/index.php/api/login`,\r\n        formData,\r\n        {\r\n          header: {\r\n            'Content-Type': 'application/x-www-form-urlencoded'\r\n          }\r\n        }).then(r => {\r\n          if (r.data !== null) {\r\n            \r\n            database.insertUser(r.data, username, passsword, funcSetregisterLocal);\r\n            if (isRegisterLocal) {\r\n              gC.setIdUser(r.data);\r\n              database.setupDatabaseAsync();\r\n              database.getFicha(gC.setDataGlobal);\r\n              navigation.navigate('PrincipalPages');\r\n            }else {\r\n              alert('no se pudieron guardar los datos del usuario localmente');\r\n              gC.setIdUser(r.data);\r\n              database.setupDatabaseAsync();\r\n              database.getFicha(gC.setDataGlobal);\r\n              navigation.navigate('PrincipalPages');\r\n            } \r\n          }\r\n        })\r\n        .catch(e => {\r\n          alert('Sus datos son incorrecto');\r\n        })\r\n    }else {\r\n      console.log(dataUser)\r\n    } \r\n  }\r\n  return (\r\n    <KeyboardAvoidingView\r\n      behavior={Platform.OS == \"ios\" ? \"padding\" : \"height\"}\r\n      style={login.container}\r\n    >\r\n      <View style={login.bgGroundDark}>\r\n        <View style={login.logoLogin}>\r\n          <Image source={require(\"../assets/images/mpps-logo.png\")} />\r\n        </View>\r\n        <View style={login.inputContainerDark}>\r\n          <TextInput\r\n            style={login.inputDark}\r\n            autoCompleteType=\"username\"\r\n            autoFocus\r\n            placeholder=\"Usuario\"\r\n            placeholderTextColor=\"white\"\r\n            onChangeText={text => setUsername(text)}\r\n          />\r\n          <TextInput\r\n            style={login.inputDark}\r\n            autoCompleteType=\"password\"\r\n            placeholder=\"Contraseña\"\r\n            placeholderTextColor=\"white\"\r\n            textContentType=\"password\"\r\n            secureTextEntry\r\n            onChangeText={text => setPassword(text)}\r\n          />\r\n        </View>\r\n        <View style={login.contentButonLogin}>\r\n          <TouchableHighlight onPress={() => goToHome()} underlayColor='transparent'>\r\n            <View style={login.buttLogin}>\r\n              <Text style={login.textButoon}>Iniciar</Text>\r\n            </View>\r\n          </TouchableHighlight>\r\n        </View>\r\n        {/**\r\n      <View style={login.singInFingerCont}>\r\n        <TouchableHighlight>\r\n          <View style={login.buttLoginFinger}>\r\n            <View style={login.textFingerCont}>\r\n              <Text style={login.textButoonFinger}>\r\n                Ingresar con huella dactilar\r\n              </Text>\r\n            </View>\r\n              * ?paradespues TODO <View style={{ marginLeft: 44 }}>\r\n              <Image\r\n                style={login.huellaSingin}\r\n                source={require(\"../assets/images/huella-dactilar.png\")}\r\n              />\r\n          </View>\r\n        </TouchableHighlight>\r\n      </View>\r\n            </View> */}\r\n        <View style={login.suisContText}>\r\n          <Text style={login.suisText}>SUIS</Text>\r\n        </View>\r\n      </View>\r\n    </KeyboardAvoidingView>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}